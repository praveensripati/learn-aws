<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:.5in .5in .5in .5in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></b></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>Use Case</span></b></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></b></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>When we deploy any
resources in AWS, which are public facing or not there is always an attempt by
the hackers to get into the resources and compromise them for their own
benefit. This resource can be an EC2 instance, an S3 Bucket, an RDS instance or
anything else. There are always hackers and we need to be on a constant alert
against them.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>AWS provides GuardDuty
which is a managed service that continuously monitors for malicious or
unauthorized behaviour to help protect your AWS accounts and workloads. Once
GuardDuty has been enabled, it automatically monitors for</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Anomalous
API activity</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Potentially
unauthorized deployments and compromised instances</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Reconnaissance
by attackers</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal align=center style='margin-bottom:0in;text-align:center;
line-height:normal'><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=698 height=236 id="Picture 1"
src="010-UseCase-GuardDuty_files/image001.png"></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>In this use case, we will
perform the below activities and check if GuardDuty is able to identify them
and alert us. These are the scenarios of a hacker attempting to get into a
system or a compromised system.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-family:"Verdana",sans-serif'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>Create a Windows EC2
instance and make a connection to a Tor Guard or an Authority node.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-family:"Verdana",sans-serif'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>Hacker performing some reconnaissance
from Kali Linux on the S3 buckets.</span></p>

<p class=MsoListParagraphCxSpMiddle><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-family:"Verdana",sans-serif'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>Invoking AWS API using root
credentials.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>All the above can involves
network traffic which can be captured by the VPC Flows, which GuardDuty
automatically analyses and checks for any anomaly. If any, it would send an event
to CloudWatch which trigger an email via SNS service.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>Note that in this use case
we create an EC2 instance and an S3 bucket and perform some of the steps which
are typically performed by hackers or any compromised applications and check if
GuardDuty is able to identify them and notify us.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>AWS Services: </span></b><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>GuardDuty, EC2, S3, VPC,
CloudWatch, SNS, SES</span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Navigate to the SNS Management Console and enter the `Topic name` and click on
`Next step`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 2"
src="010-UseCase-GuardDuty_files/image002.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Go with all the default options and click on `Create topic`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 4"
src="010-UseCase-GuardDuty_files/image003.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Click on `Create subscription`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 5"
src="010-UseCase-GuardDuty_files/image004.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Select Email for the Protocol and the email address for the Endpoint. Click on
`Create subscription`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 6"
src="010-UseCase-GuardDuty_files/image005.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
SNS would be sending an email and we need to open the email and click on the
link to change the status of the subscription from pending to confirmed status.
Once in a while the email is marked as spam. So, make sure to check the spam
folder also.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 7"
src="010-UseCase-GuardDuty_files/image006.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Go to the CloudWatch Management Console and to the Rules tab. Click on `Create
rule`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 8"
src="010-UseCase-GuardDuty_files/image007.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Enter the attached event-pattern.json in the `Event Source`. Click on `Add
target`.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN><img
width=103 height=66 src="010-UseCase-GuardDuty_files/image008.png"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 9"
src="010-UseCase-GuardDuty_files/image009.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Select the `SNS Topic` and the Topic created in the previous steps. Select
`Input Transformer` and enter the below JSON.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>{<br>
    &quot;severity&quot;: &quot;$.detail.severity&quot;,<br>
    &quot;Finding_ID&quot;: &quot;$.detail.id&quot;,<br>
    &quot;Finding_Type&quot;: &quot;$.detail.type&quot;,<br>
    &quot;region&quot;: &quot;$.region&quot;,<br>
    &quot;Finding_description&quot;: &quot;$.detail.description&quot;<br>
}</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>And
for the `Input Template` enter the below text and click on `Configure details`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&quot;You
have a severity &lt;severity&gt; GuardDuty finding type &lt;Finding_Type&gt; in
the &lt;region&gt; region.&quot;<br>
&quot;Finding Description:&quot;<br>
&quot;&lt;Finding_description&gt;. &quot;<br>
&quot;For more details open the GuardDuty console at
https://console.aws.amazon.com/guardduty/home?region=&lt;region&gt;#/findings?search=id%3D&lt;Finding_ID&gt;&quot;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 10"
src="010-UseCase-GuardDuty_files/image010.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Give the rule a name and enter some description. Click on `Create rule` to
create the rule.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 11"
src="010-UseCase-GuardDuty_files/image011.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
<img width=697 height=355 id="Picture 12"
src="010-UseCase-GuardDuty_files/image012.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Navigate to the GuardDuty Management Console and click on `Get started`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 13"
src="010-UseCase-GuardDuty_files/image013.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Click on `Enable GuardDuty`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 14"
src="010-UseCase-GuardDuty_files/image014.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
GuardDuty is free for 30 days once we enable it. Go to the Usage tab to figure
out how many days are left for free.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 15"
src="010-UseCase-GuardDuty_files/image015.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Under the Settings tab change the `Frequency for updated findings` to 15
minutes and click on Save.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 16"
src="010-UseCase-GuardDuty_files/image016.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
For some reason, if we want to disable GuardDuty then in the same Settings tab,
there is an option `Disable GuardDuty`. For now, keep it enabled, so there is
no need to make any changes.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 17"
src="010-UseCase-GuardDuty_files/image017.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
In the EC2 Management Console, create a Security Group with the all the traffic
allowed inbound as shown below. This is not really a recommended approach, but
is fine for the same of demos.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 18"
src="010-UseCase-GuardDuty_files/image018.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Launch an EC2 instance and select `Kali Linux` under the `AWS Marketplace`.
`Kali Linux` is mainly used for penetration testing and any action which we
take against AWS resources will be captured by GuardDuty as an anomaly.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 19"
src="010-UseCase-GuardDuty_files/image019.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Click on Continue around the pricing details.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 20"
src="010-UseCase-GuardDuty_files/image020.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Make sure to select `t2.micro` as it falls under the AWS free trial. Click on
Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 21"
src="010-UseCase-GuardDuty_files/image021.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Go with the default options under the `Configure Instance Details` and click
on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 22"
src="010-UseCase-GuardDuty_files/image022.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
On this EC2 instance, we would be installing a bunch of softwares so change the
storage from the default 8GB to 15GB. Click on Next,</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 23"
src="010-UseCase-GuardDuty_files/image023.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Tags are optional. Click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 24"
src="010-UseCase-GuardDuty_files/image024.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Under the `Select an existing security group` select the Security Group which
has been created in the previous step. Click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 25"
src="010-UseCase-GuardDuty_files/image025.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Review all the details and click on Launch.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 26"
src="010-UseCase-GuardDuty_files/image026.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Make sure to select the KeyPair, select `I acknowledge ….` and click on `Launch
Instances`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 27"
src="010-UseCase-GuardDuty_files/image027.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
The EC2 instances would in a `running` state in a few minutes.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=698 height=356 id="Picture 28"
src="010-UseCase-GuardDuty_files/image028.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Go to the IAM Management Console and to the Roles tab. Click on `Create role`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 29"
src="010-UseCase-GuardDuty_files/image029.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Select EC2 under `Common use cases` and click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 30"
src="010-UseCase-GuardDuty_files/image030.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Select `AdministratorAccess` Policy and click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 31"
src="010-UseCase-GuardDuty_files/image031.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Tags are optional. Click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 32"
src="010-UseCase-GuardDuty_files/image032.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Give the Role a name and click on `Create role`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 33"
src="010-UseCase-GuardDuty_files/image033.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Attach the IAM Role to the earlier created EC2 instance.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=698 height=356 id="Picture 35"
src="010-UseCase-GuardDuty_files/image034.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Connect to the EC2 instance via Putty or some other SSH client. Note that the
user name to connect to the EC2 instance is `kali`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=698 height=422 id="Picture 36"
src="010-UseCase-GuardDuty_files/image035.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
The below actions have to be performed on the Kali Linux</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>a)
Execute the below commands</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>sudo
apt update<br>
sudo apt install -y xfce4 xfce4-goodies tightvncserver midori python3
python3-pip<br>
pip install awscli –upgrade<br>
export PATH=&quot;$PATH:/home/ubuntu/.local/bin/&quot;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>b)
Execute the `aws configure` command and enter `us-east-1` for the default
Region and leave rest of the fields without anything.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>c)
Execute the `vncpasswd` command and enter the `kali123` password thrice as
shown below at the end.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=698 height=418 id="Picture 37"
src="010-UseCase-GuardDuty_files/image036.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>d)
Create a file in the ~/.vnc/xstartup path with the below content</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>#!/bin/bash<br>
xrdb $HOME/.Xresources<br>
startxfce4 &amp;<br>
<br>
e) Change the permissions on the above file and execute the vncserver command.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>chmod
+x ~/.vnc/xstartup<br>
vncserver<br>
<br>
</span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Create a file called `threat-list.txt` with the IP address of Google and the
Public IP of the EC2, one IP address per line as shown below. The IP address of
the Google can be got by executing `ping google.com` command from the Windows
Command Prompt.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>a.b.c.d<br>
m.n.o.p</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Create
an S3 bucket and upload the file as shown below.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 38"
src="010-UseCase-GuardDuty_files/image037.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Go back to the GuardDuty Management Console and click on Lists under Settings.
Click on `Add a threat list`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 39"
src="010-UseCase-GuardDuty_files/image038.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Give the list a name, enter the proper location of the file in S3 from the
previous step. For the format select `Plaintext`. And finally click on `I
agree` and `Add list`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
width=697 height=355 id="Picture 40"
src="010-UseCase-GuardDuty_files/image039.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
<img width=697 height=355 id="Picture 41"
src="010-UseCase-GuardDuty_files/image040.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
From the Putty session connected to the Kali Linux execute the below AWS CLI
commands to get the list of S3 buckets and Security Groups. This should be
identified as an anomaly by the GuardDuty as the commands are run from Kali
Linux which is mainly used for penetration testing.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>aws
s3 ls<br>
aws ec2 describe-security-groups</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Download the VNC Viewer from the below URL and install it as with any other
software on the Windows OS. We would be using this later to get the GUI access
to the Kali Linux EC2 instance.</span></p>

<p class=MsoNormal><span lang=EN-IN><a
href="https://www.realvnc.com/en/connect/download/viewer/"><span
style='font-family:"Verdana",sans-serif'>https://www.realvnc.com/en/connect/download/viewer/</span></a></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Start the VNC Viewer. Go to `File -&gt; New Connection..`.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'><img border=0 width=549 height=396
id="Picture 42" src="010-UseCase-GuardDuty_files/image041.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Enter the VNC Server details in the below format and click on OK.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>public-ip-of-ec2:5901</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'><img border=0 width=529 height=383
id="Picture 43" src="010-UseCase-GuardDuty_files/image042.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
An entry should be created as shown below. Double click on it to connect to the
Kali Linux.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'><img border=0 width=534 height=385
id="Picture 44" src="010-UseCase-GuardDuty_files/image043.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
When prompted with a warning on `Unencrypted connection`, select `Don’t warn
….` and click on `Continue`.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'><img border=0 width=537 height=385
id="Picture 45" src="010-UseCase-GuardDuty_files/image044.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Enter the password as `kali123`, select `Remember password` and click on OK.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'><img border=0 width=573 height=411
id="Picture 46" src="010-UseCase-GuardDuty_files/image045.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
The Kali Linux GUI will be displayed as shown below. Navigate to `Applications
-&gt; Internet -&gt; Modori` as shown below and start the browser.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'><img border=0 width=506 height=395
id="Picture 47" src="010-UseCase-GuardDuty_files/image046.jpg"></span><span
lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
<br>
</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Naviagte to google.com using the IP which we got from one of the previous step
and the one which has been added to the `threat-list.txt` file in S3. It would
redirect to the Google page automatically from the IP address as shown below.
This activity also should be triggered as an anomaly by GuardDuty as we have
included the Google IP in the threat list for GuardDuty.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'><img border=0 width=506 height=394
id="Picture 63" src="010-UseCase-GuardDuty_files/image047.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
From the EC2 Management Console, launch and EC2 instance and select `Microsoft
Windows Server 2019 Base`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 48"
src="010-UseCase-GuardDuty_files/image048.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Select `t2.micro` and click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 49"
src="010-UseCase-GuardDuty_files/image049.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Go with all the default options and click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 50"
src="010-UseCase-GuardDuty_files/image050.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Go with the default storage and click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 51"
src="010-UseCase-GuardDuty_files/image051.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Tags are optional. Click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 52"
src="010-UseCase-GuardDuty_files/image052.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Select the Security Group which has been created in one of the previous
steps. Click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 53"
src="010-UseCase-GuardDuty_files/image053.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Review all the details and click on Launch.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 54"
src="010-UseCase-GuardDuty_files/image054.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Select the KeyPair, select `I acknowledge ….` and click `Launch Instances`.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 55"
src="010-UseCase-GuardDuty_files/image055.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
In a few minutes the EC2 would be in a running state.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=698 height=356 id="Picture 56"
src="010-UseCase-GuardDuty_files/image056.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Connect to the EC2 instance as usual using the RDP protocol.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=698 height=398 id="Picture 57"
src="010-UseCase-GuardDuty_files/image057.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Inside the EC2 instance perform the below steps which allows the software to be
downloaded by IE.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>       
- Go to Start &gt; Server Manager &gt; Local Server<br>
        - Click the On link to the right of IE Enhanced Security Configuration<br>
        - Click Off under the Administrators and Users section and Click OK</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Download the Tor browser for Windows from the below URL and install it as like
any other application.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>https://torproject.org/download</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=698 height=407 id="Picture 58"
src="010-UseCase-GuardDuty_files/image058.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Once the Tor browser has been installed there would be an icon on the Desktop
as shown below. Use it to start the Tor browser. Click on the `Connect` button.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=698 height=358 id="Picture 59"
src="010-UseCase-GuardDuty_files/image059.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- In a few seconds the Tor browser would be started in the EC2 instance.
Navigate to any onion site. Maybe to </span><span lang=EN-IN><a
href="http://zlibraryexau2g3p.onion"><span style='font-family:"Verdana",sans-serif'>http://zlibraryexau2g3p.onion</span></a></span><span
lang=EN-IN style='font-family:"Verdana",sans-serif'> in the Tor browser. This
should also trigger an anomaly in the GuardDuty as we are visiting a Tor site.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=358 id="Picture 60"
src="010-UseCase-GuardDuty_files/image060.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>--
Go back to the GuardDuty Management Console and there should be a bunch of
Findings which GuardDuty has found out as anomalies in the different activities
which we performed.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=697 height=355 id="Picture 61"
src="010-UseCase-GuardDuty_files/image061.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><br>
-- Also, we would be getting an email as shown below, since we have integrated
GuardDuty events with SNS Notifications via the CloudWatch Rules.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'><img
border=0 width=698 height=356 id="Picture 62"
src="010-UseCase-GuardDuty_files/image062.jpg"></span></p>

<span lang=EN-IN style='font-size:11.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Conclusion</span></b></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>In
this use case we tried to perform few actions which are typically performed by
hackers</span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Use
Kali Linux to probe AWS resources</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Use
Root IAM role to perform AWS activities</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-IN style='font-family:"Verdana",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Use a
TOR Client on an EC2 instance</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span lang=EN-IN
style='font-family:"Verdana",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Used a
browser to reach a malicious IP address</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-family:"Verdana",sans-serif'>Immediately
these activities have been identified by GuardDuty as anomaly and an email
alert has been sent via SNS Topic.</span></p>

</div>

</body>

</html>
