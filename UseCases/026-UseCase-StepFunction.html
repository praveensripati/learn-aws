<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:.5in .5in .5in .5in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>Use Case</span></b></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>In real
world we have applications which have components spread across different
servers/locations which requires coordination and the same has to be managed by
the application code and it becomes complicated with time and also difficult to
manage.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'><br>
To make it easy AWS provides AWS StepFunctions to create workflows which can
coordinate application logic across distributed systems as shown below. Here we
have an upstream application invoking a workflow with the order details. The
workflow will perform the below steps</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>Update the
DynamoDB with the order details</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>Check if
the order details are proper</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>If proper
put a message in the OrderFufillment Queue</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0in;text-indent:-.25in;
line-height:normal'><span lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>Else put a
message in the Escalation Queue</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'><br>
The downstream application would read the messages from these Queues and
process the messages further.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal align=center style='margin-bottom:0in;text-align:center;
line-height:normal'><span lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'><img
width=583 height=226 id="Picture 7"
src="026-UseCase-StepFunction_files/image001.jpg"></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>Below is
the workflow as depicted by the AWS StepFunctions. The above and below diagram
do represent the same workflow with a different way of representation.</span></p>

<p class=MsoNormal align=center style='margin-bottom:0in;text-align:center;
line-height:normal'><span lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'><img
width=318 height=250 id="Picture 37"
src="026-UseCase-StepFunction_files/image002.jpg"></span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>AWS
Services:</span></b><span lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>
StepFunctions, SQS, DynamoDB and Lambda.</span></p>

<p class=MsoNormal align=center style='margin-bottom:0in;text-align:center;
line-height:normal'><span lang=EN-IN style='font-size:12.0pt;font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go to the DynamoDB Management Console and
click on “Create table”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 48"
src="026-UseCase-StepFunction_files/image003.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><br>
<br>
</span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Enter the table name as OrderTable and the
PartitionKey as OrderId/String. Click on Create. The table would be created in
a few minutes with no Items as shown below.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=698 height=338 id="Picture 49"
src="026-UseCase-StepFunction_files/image004.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 50"
src="026-UseCase-StepFunction_files/image005.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go to the SQS Management Console and click
on “Create queue”. Specify the Queue name as OrderFulfillmentQueue and click on
“Create Queue”. The default options are good enough.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 52"
src="026-UseCase-StepFunction_files/image006.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 53"
src="026-UseCase-StepFunction_files/image007.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- The Queue will be created as shown below.
Note down the URL for the Queue, the same would be used later.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 54"
src="026-UseCase-StepFunction_files/image008.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Create another Queue EscalationQueue and
note down the Queue URL.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 55"
src="026-UseCase-StepFunction_files/image009.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go to the IAM Management Console. Click on
the Roles link in the left pane. Click on “Create role”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 56"
src="026-UseCase-StepFunction_files/image010.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><br>
-- Select Lambda as the service which is going to use this IAM Role. Click on
“Next Permissions”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 57"
src="026-UseCase-StepFunction_files/image011.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Select the AWSLambdaBasicExecutionRole
Policy and click on “Next Tags”. Tags are optional, so click on “Create Role”
without any changes. </span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 58"
src="026-UseCase-StepFunction_files/image012.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><br>
-- Enter the Role name  as RoleForLambda and click on “Create role”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 59"
src="026-UseCase-StepFunction_files/image013.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- The Role would be created as shown below.
The same would be attached to the Lambda function later.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 60"
src="026-UseCase-StepFunction_files/image014.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go to the Lambda Management Console and
click on “Create function”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 61"
src="026-UseCase-StepFunction_files/image015.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Enter the function name as VerifyCCAndPrice,
select Python2.7 as the Runtime and expand “Choose an existing role”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 62"
src="026-UseCase-StepFunction_files/image016.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Select “Use an existing role” and select
the IAM Role created in the previous steps. Click on “Create function”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 63"
src="026-UseCase-StepFunction_files/image017.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><br>
<br>
</span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Replace the Python code with the below
code. The Lambda checks for the validity of the Credit Card and Price and
returns the appropriate StatusCode with other details. Click on Save.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>def lambda_handler(event, context):</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>   if ( len(event['CC']) == 16 and
int(event['Price']) &gt; 0 ):<br>
      StatusCode = 1<br>
   else:<br>
      StatusCode = 0<br>
   return { <br>
      'Status' : StatusCode,<br>
      'OrderId': event['OrderId'],<br>
      'Name': event['Name'],<br>
      'ItemName': event['ItemName'],<br>
      'Price': event['Price'],<br>
      'CC' : event['CC']<br>
   }</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 64"
src="026-UseCase-StepFunction_files/image018.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go back to the IAM Management Console and
create a Role. Select the Step Functions as the Service which is going to use
this Role. Click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 65"
src="026-UseCase-StepFunction_files/image019.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><br>
-- Go with the default options and click on Next.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 66"
src="026-UseCase-StepFunction_files/image020.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Enter the Role name as
RoleForOrderFulfillmentStepFunctions” and click on “Create role”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 67"
src="026-UseCase-StepFunction_files/image021.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- The IAM Role would be created as shown
below.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 68"
src="026-UseCase-StepFunction_files/image022.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Click on “Attach policies” and add the
below additional policies to the Role.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>        - AmazonSQSFullAccess<br>
        - AmazonDynamoDBFullAccess<br>
        - AmazonLambdaBasicExecutionRole<br>
<br>
This IAM Role we would be using the Step Functions later and the IAM Role
should be displayed as shown below.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 69"
src="026-UseCase-StepFunction_files/image023.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go to the Step Functions Management
Console and click on “Burger” on the top left and click on “State machines”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 70"
src="026-UseCase-StepFunction_files/image024.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Click on “Create state machine”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 71"
src="026-UseCase-StepFunction_files/image025.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go with the default options.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 72"
src="026-UseCase-StepFunction_files/image026.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><br>
-- Paste the below JSON in the definition. This defines the workflow. Click on
the refresh button and notice the workflow on the right pane getting updated as
shown below. Make sure to replace the Lambda ARN and SQS URL for both the
Queues in the JSON code. Click on Next.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-IN
style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><img
width=697 height=337 id="Picture 73"
src="026-UseCase-StepFunction_files/image027.jpg"></span></p>

<span lang=EN-IN style='font-size:8.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:8.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:7.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>{<br>
   &quot;Comment&quot;:&quot;A state machine that automates a order
fulfillment.&quot;,<br>
   &quot;StartAt&quot;:&quot;Update the order table&quot;,<br>
   &quot;States&quot;:{<br>
      &quot;Update the order table&quot;:{<br>
         &quot;Type&quot;:&quot;Task&quot;,<br>
         &quot;Resource&quot;:&quot;arn:aws:states:::dynamodb:putItem&quot;,<br>
         &quot;Parameters&quot;:{<br>
            &quot;TableName&quot;:&quot;OrderTable&quot;,<br>
            &quot;Item&quot;:{<br>
               &quot;OrderId&quot;:{<br>
                  &quot;S.$&quot;:&quot;$.OrderId&quot;<br>
               },<br>
               &quot;Name&quot;:{<br>
                  &quot;S.$&quot;:&quot;$.Name&quot;<br>
               },<br>
               &quot;ItemName&quot;:{<br>
                  &quot;S.$&quot;:&quot;$.ItemName&quot;<br>
               },<br>
               &quot;Price&quot;:{<br>
                  &quot;S.$&quot;:&quot;$.Price&quot;<br>
               },<br>
               &quot;CC&quot;:{<br>
                  &quot;S.$&quot;:&quot;$.CC&quot;<br>
               }<br>
            }<br>
         },<br>
                                 &quot;ResultPath&quot;:null,<br>
         &quot;Next&quot;:&quot;Are details Proper&quot;<br>
      },<br>
      &quot;Are details Proper&quot;:{<br>
         &quot;Type&quot;:&quot;Task&quot;,<br>
        
&quot;Resource&quot;:&quot;arn:aws:lambda:us-east-1:304000509264:function:VerifyCCAndPrice&quot;,<br>
         &quot;Next&quot;:&quot;Put message in Queue&quot;<br>
      },<br>
      &quot;Put message in Queue&quot;:{<br>
         &quot;Type&quot;:&quot;Choice&quot;,<br>
         &quot;Choices&quot;:[<br>
            {<br>
               &quot;Variable&quot;:&quot;$.Status&quot;,<br>
               &quot;NumericEquals&quot;:1,<br>
               &quot;Next&quot;:&quot;Put message in order OrderFulfillment
Queue&quot;<br>
            },<br>
            {</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:7.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>              
&quot;Variable&quot;:&quot;$.Status&quot;,<br>
               &quot;NumericEquals&quot;:0,<br>
               &quot;Next&quot;:&quot;Put message in order Escalation
Queue&quot;<br>
            }<br>
         ]<br>
      },<br>
      &quot;Put message in order OrderFulfillment Queue&quot;:{<br>
         &quot;Type&quot;:&quot;Task&quot;,<br>
         &quot;Resource&quot;:&quot;arn:aws:states:::sqs:sendMessage&quot;,<br>
         &quot;Parameters&quot;:{<br>
           
&quot;QueueUrl&quot;:&quot;https://sqs.us-east-1.amazonaws.com/304000509264/OrderFulfillmentQueue&quot;,<br>
            &quot;MessageBody.$&quot;:&quot;$.OrderId&quot;<br>
         },<br>
         &quot;End&quot;:true<br>
      },<br>
      &quot;Put message in order Escalation Queue&quot;:{<br>
         &quot;Type&quot;:&quot;Task&quot;,<br>
         &quot;Resource&quot;:&quot;arn:aws:states:::sqs:sendMessage&quot;,<br>
         &quot;Parameters&quot;:{<br>
           
&quot;QueueUrl&quot;:&quot;https://sqs.us-east-1.amazonaws.com/304000509264/EscalationQueue&quot;,<br>
            &quot;MessageBody.$&quot;:&quot;$.OrderId&quot;<br>
         },<br>
         &quot;End&quot;:true<br>
      }<br>
   }<br>
}</span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Specify the state machine name as
“OrderFulfillmentStateMachine”. Select the “Choose an existing role” options
under permissions and select the Role which has been created for State
Functions earlier. This will give the permissions to the state machine to
interact with the different AWS Services.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 74"
src="026-UseCase-StepFunction_files/image028.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go with the rest of the default options
and click on “Create state machine”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 75"
src="026-UseCase-StepFunction_files/image029.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- The state machine would be created as
shown below.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 76"
src="026-UseCase-StepFunction_files/image030.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- The state machine takes JSON as the input.
Here are some sample inputs which can be used with the workflow.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:8.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>1. All the data is valid.<br>
<br>
{<br>
   &quot;OrderId&quot;: &quot;001&quot;,<br>
   &quot;Name&quot;: &quot;Praveen Sripati&quot;,<br>
   &quot;ItemName&quot;: &quot;Lenovo ThinkPad E14&quot;,<br>
   &quot;Price&quot;: &quot;80000&quot;,<br>
   &quot;CC&quot; : &quot;1234123456785678&quot;<br>
}</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:8.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>2. Invalid Price.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:8.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>{<br>
   &quot;OrderId&quot;: &quot;002&quot;,<br>
   &quot;Name&quot;: &quot;Praveen Sripati&quot;,<br>
   &quot;ItemName&quot;: &quot;Lenovo ThinkPad E14&quot;,<br>
   &quot;Price&quot;: &quot;-123&quot;,<br>
   &quot;CC&quot; : &quot;1234123456785678&quot;<br>
}</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:8.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>3. Invalid CC.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:8.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>{<br>
   &quot;OrderId&quot;: &quot;003&quot;,<br>
   &quot;Name&quot;: &quot;Praveen Sripati&quot;,<br>
   &quot;ItemName&quot;: &quot;Lenovo ThinkPad E14&quot;,<br>
   &quot;Price&quot;: &quot;80000&quot;,<br>
   &quot;CC&quot; : &quot;123412345678&quot;<br>
}</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:8.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>4. Invalid CC and Price.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:8.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>{<br>
   &quot;OrderId&quot;: &quot;004&quot;,<br>
   &quot;Name&quot;: &quot;Praveen Sripati&quot;,<br>
   &quot;ItemName&quot;: &quot;Lenovo ThinkPad E14&quot;,<br>
   &quot;Price&quot;: &quot;-123&quot;,<br>
   &quot;CC&quot; : &quot;123412345678&quot;<br>
}</span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Click on “Start execution” and enter a
valid JSON and again click on “Start execution”.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 77"
src="026-UseCase-StepFunction_files/image031.jpg"></span><span lang=EN-IN
style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br>
<br>
</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- The “Execution Status” should be succeed.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 78"
src="026-UseCase-StepFunction_files/image032.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- And the workflow should be as shown below.
Notice the path in the workflow.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 79"
src="026-UseCase-StepFunction_files/image033.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go to the DynamoDB Management Console and
an item should be inserted into the table.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 80"
src="026-UseCase-StepFunction_files/image034.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go to the SQS Management Console and there
should be an item in the OrderFulfillmentQueue for the downstream applications
to process it further.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 81"
src="026-UseCase-StepFunction_files/image035.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><br>
-- This time execute the workflow with an invalid message. In the below screen,
notice that the price is negative.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 82"
src="026-UseCase-StepFunction_files/image036.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- The workflow should appear as shown below.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 83"
src="026-UseCase-StepFunction_files/image037.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><br>
-- An item should be inserted into the DynamoDB table.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 84"
src="026-UseCase-StepFunction_files/image038.jpg"></span></p>

<span lang=EN-IN style='font-size:12.0pt;line-height:115%;font-family:"Verdana",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- A message would be put in the
EscalationQueue for the downstream application to be processed further.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 85"
src="026-UseCase-StepFunction_files/image039.jpg"></span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'>-- Go to the CloudWatch Management Console
and any error messages from the Lambda execution should appear hear if any.</span></p>

<p class=MsoNormal><span lang=EN-IN style='font-size:12.0pt;line-height:115%;
font-family:"Verdana",sans-serif'><img width=697 height=337 id="Picture 86"
src="026-UseCase-StepFunction_files/image040.jpg"></span></p>

</div>

</body>

</html>
